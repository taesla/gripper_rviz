# OnRobot RG2 Gripper RViz Synchronization

> **ì‹¤ì œ ê·¸ë¦¬í¼ ìƒíƒœë¥¼ RVizì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ì‹œê°í™”í•˜ëŠ” ROS2 íŒ¨í‚¤ì§€**

Doosan M0609 ë¡œë´‡ì— ì¥ì°©ëœ OnRobot RG2 ê·¸ë¦¬í¼ì˜ ì‹¤ì œ ë™ì‘ ìƒíƒœë¥¼ Modbus TCP í†µì‹ ìœ¼ë¡œ ì½ì–´ì™€ RViz URDF ëª¨ë¸ê³¼ ë™ê¸°í™”í•©ë‹ˆë‹¤.

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#1-ê°œìš”)
2. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#2-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
3. [í•˜ë“œì›¨ì–´ ë¶„ì„ ë° ì„¤ê³„ ê·¼ê±°](#3-í•˜ë“œì›¨ì–´-ë¶„ì„-ë°-ì„¤ê³„-ê·¼ê±°)
4. [í†µì‹  í”„ë¡œí† ì½œ ì„¤ê³„](#4-í†µì‹ -í”„ë¡œí† ì½œ-ì„¤ê³„)
5. [URDF ì¡°ì¸íŠ¸ ë§¤í•‘](#5-urdf-ì¡°ì¸íŠ¸-ë§¤í•‘)
6. [ROS2 í† í”½ êµ¬ì¡°](#6-ros2-í† í”½-êµ¬ì¡°)
7. [ì„¤ì¹˜ ë° ì‚¬ìš©ë²•](#7-ì„¤ì¹˜-ë°-ì‚¬ìš©ë²•)
8. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#8-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)
9. [ì°¸ê³  ìë£Œ](#9-ì°¸ê³ -ìë£Œ)

---

## 1. ê°œìš”

### 1.1 ë¬¸ì œ ì •ì˜

ê¸°ì¡´ RViz ì‹œê°í™”ì—ì„œ ê·¸ë¦¬í¼ëŠ” í•­ìƒ **ê³ ì •ëœ ìƒíƒœ(ì—´ë¦° ìƒíƒœ)**ë¡œ í‘œì‹œë˜ì–´, ì‹¤ì œ ë¡œë´‡ ì‘ì—… ì‹œ ê·¸ë¦¬í¼ì˜ í˜„ì¬ ìƒíƒœë¥¼ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ì—†ì—ˆìŠµë‹ˆë‹¤.

**ëª©í‘œ:**
- ì‹¤ì œ ê·¸ë¦¬í¼ê°€ ë‹«íˆë©´ â†’ RVizì—ì„œë„ ë‹«í˜
- ì‹¤ì œ ê·¸ë¦¬í¼ê°€ ì—´ë¦¬ë©´ â†’ RVizì—ì„œë„ ì—´ë¦¼
- ì‹¤ì‹œê°„ ë™ê¸°í™” (30Hz)

### 1.2 í•´ê²° ë°©ì•ˆ íƒìƒ‰

ê·¸ë¦¬í¼ ìƒíƒœë¥¼ ROS2ì—ì„œ ì½ì–´ì˜¤ëŠ” ë°©ë²•ì„ ì¡°ì‚¬í•œ ê²°ê³¼, ë‘ ê°€ì§€ ì˜µì…˜ì´ ìˆì—ˆìŠµë‹ˆë‹¤:

| ì—°ê²° ë°©ì‹ | ì¥ì  | ë‹¨ì  |
|-----------|------|------|
| **Tool Flange I/O** | ê°„ë‹¨í•œ ë°°ì„  | ON/OFFë§Œ ê°€ëŠ¥, **ìœ„ì¹˜ í”¼ë“œë°± ë¶ˆê°€** |
| **Modbus TCP (LAN)** | ìœ„ì¹˜ ì œì–´ + **í”¼ë“œë°± ê°€ëŠ¥** | Compute Box í•„ìš” |

**ê²°ë¡ :** Modbus TCPë¥¼ í†µí•œ ìœ„ì¹˜ í”¼ë“œë°± ë°©ì‹ ì„ íƒ

---

## 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ì‹¤ì œ í•˜ë“œì›¨ì–´                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         LAN          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Doosan      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  OnRobot             â”‚    â”‚
â”‚  â”‚  M0609       â”‚   192.168.1.100     â”‚  Compute Box         â”‚    â”‚
â”‚  â”‚  Controller  â”‚                      â”‚  192.168.1.1:502     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                   â”‚                â”‚
â”‚                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚                                         â”‚  OnRobot RG2      â”‚      â”‚
â”‚                                         â”‚  Gripper          â”‚      â”‚
â”‚                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ Modbus TCP
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ROS2 ë…¸ë“œ êµ¬ì¡°                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  gripper_state_publisher                                    â”‚    â”‚
â”‚  â”‚  â”œâ”€ Modbus TCP ì—°ê²° (pymodbus)                              â”‚    â”‚
â”‚  â”‚  â”œâ”€ í˜„ì¬ í­(mm) ì½ê¸° â†’ Register 267                         â”‚    â”‚
â”‚  â”‚  â”œâ”€ í­ â†’ ì¡°ì¸íŠ¸ ê°ë„ ë³€í™˜                                    â”‚    â”‚
â”‚  â”‚  â””â”€ /gripper/joint_states ë°œí–‰                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                         â”‚
â”‚                           â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  joint_state_merger                                         â”‚    â”‚
â”‚  â”‚  â””â”€ /dsr01/joint_statesë¡œ ê·¸ë¦¬í¼ ì¡°ì¸íŠ¸ ë°œí–‰                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                         â”‚
â”‚                           â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  robot_state_publisher (ê¸°ì¡´)                               â”‚    â”‚
â”‚  â”‚  â”œâ”€ ë¡œë´‡ 6ì¶• + ê·¸ë¦¬í¼ 2ì¶• ì¡°ì¸íŠ¸ ìˆ˜ì‹                         â”‚    â”‚
â”‚  â”‚  â””â”€ TF ë³€í™˜ ë°œí–‰ â†’ RViz                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           RViz2                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  RobotModel                                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ /dsr01/joint_states êµ¬ë…                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ URDF ì¡°ì¸íŠ¸ ìœ„ì¹˜ ì—…ë°ì´íŠ¸                                 â”‚   â”‚
â”‚  â”‚  â””â”€ ë¡œë´‡ + ê·¸ë¦¬í¼ ì‹¤ì‹œê°„ ì‹œê°í™”                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. í•˜ë“œì›¨ì–´ ë¶„ì„ ë° ì„¤ê³„ ê·¼ê±°

### 3.1 OnRobot Compute Box ë¶„ì„

OnRobot WebClient ëŒ€ì‹œë³´ë“œ (`http://192.168.1.1`)ë¥¼ í†µí•´ ë‹¤ìŒ ì •ë³´ë¥¼ í™•ì¸í–ˆìŠµë‹ˆë‹¤:

**Device Info:**
| í•­ëª© | ê°’ |
|------|-----|
| ëª¨ë¸ | RG2 |
| Serial Number | 1000037065 |
| Firmware | 1.0.6#766B45AE |
| Compute Box | CBV35610 (Firmware 150) |

**Network Settings:**
| í•­ëª© | ê°’ |
|------|-----|
| IP Address | 192.168.1.1 |
| Subnet Mask | 255.255.255.0 |
| Digital I/O Mode | PNP |
| DHCP Server | Enabled |

**ì‹¤ì‹œê°„ ìƒíƒœ (Monitor and Control íƒ­):**
- Current width: ì‹¤ì‹œê°„ í­ í‘œì‹œ (0~110mm)
- Grip detected: ë¬¼ì²´ ê°ì§€ ìƒíƒœ
- Force ì„¤ì •: 3~40N
- Width ì„¤ì •: 0~101mm (Fingertip offset í¬í•¨)

### 3.2 Doosan ì»¨íŠ¸ë¡¤ëŸ¬ ë„¤íŠ¸ì›Œí¬ ë¶„ì„

**Doosan Robotics ì„¤ì¹˜ ë§¤ë‰´ì–¼ (V2.8)**ì—ì„œ í™•ì¸í•œ ë„¤íŠ¸ì›Œí¬ êµ¬ì„±:

```
ì»¨íŠ¸ë¡¤ëŸ¬ ë„¤íŠ¸ì›Œí¬ í¬íŠ¸:
â”œâ”€ WAN: ì™¸ë¶€ ì¸í„°ë„· ë§ ì—°ê²°
â”œâ”€ LAN1~3: TCP/IP, Modbus í”„ë¡œí† ì½œ ì£¼ë³€ê¸°ê¸° ì—°ê²°
â”‚          IP ëŒ€ì—­: 192.168.137.xxx
â””â”€ LAN4: ë‚´ë¶€ ì œì–´ê¸°ìš© (ì‚¬ìš© ê¸ˆì§€)
```

**I/O ì¸í„°í˜ì´ìŠ¤ ë§¤ë‰´ì–¼**ì—ì„œ í™•ì¸í•œ Tool Flange I/O ì œí•œ:
- M8 8í•€ ì»¤ë„¥í„° 2ê°œ (X1, X2)
- ë””ì§€í„¸ ì…ì¶œë ¥ë§Œ ì§€ì› (ON/OFF)
- **ìœ„ì¹˜ í”¼ë“œë°± ë¶ˆê°€** â†’ Modbus TCP ì„ íƒì˜ ê·¼ê±°

### 3.3 Modbus TCP í”„ë¡œí† ì½œ ì„ íƒ ê·¼ê±°

**OnRobot RG2 Modbus Register Map** (GitHub: ian-chuang/OnRobot-RG2FT-ROS ì°¸ê³ ):

| Register | ê¸°ëŠ¥ | ë²”ìœ„ | ë‹¨ìœ„ |
|----------|------|------|------|
| 0 (Write) | Target Force | 0-400 | 0.1N |
| 1 (Write) | Target Width | 0-1100 | 0.1mm |
| 2 (Write) | Control | 1 = Grip | - |
| 267 (Read) | **Current Width** | 0-1100 | 0.1mm |
| 268 (Read) | Grip Detected | 0/1 | - |
| 258 (Read) | Device Type | 45 (RG2) | - |

**ì—°ê²° ì„¤ì •:**
- Host: 192.168.1.1
- Port: 502 (Modbus TCP í‘œì¤€)
- Unit ID: 65 (OnRobot ê¸°ë³¸ê°’)

### 3.4 ì‹¤ì œ Modbus í†µì‹  í…ŒìŠ¤íŠ¸

```python
from pymodbus.client.sync import ModbusTcpClient

client = ModbusTcpClient('192.168.1.1', port=502)
client.connect()

# í˜„ì¬ í­ ì½ê¸°
result = client.read_holding_registers(267, 1, unit=65)
width_mm = result.registers[0] / 10.0  # 0.1mm â†’ mm
print(f"í˜„ì¬ ê·¸ë¦¬í¼ í­: {width_mm} mm")  # ì¶œë ¥: 11.0 mm

# ê·¸ë¦¬í¼ ì—´ê¸° (80mm)
client.write_register(0, 200, unit=65)  # Force: 20N
client.write_register(1, 800, unit=65)  # Width: 80mm
client.write_register(2, 1, unit=65)    # Command: Grip
```

**í…ŒìŠ¤íŠ¸ ê²°ê³¼:**
- âœ… Modbus ì—°ê²° ì„±ê³µ
- âœ… ê·¸ë¦¬í¼ í­ ì½ê¸° ì„±ê³µ (ì‹¤ì‹œê°„)
- âœ… ê·¸ë¦¬í¼ ì œì–´ ì„±ê³µ (ì—´ê¸°/ë‹«ê¸°)

---

## 4. í†µì‹  í”„ë¡œí† ì½œ ì„¤ê³„

### 4.1 ë°ì´í„° íë¦„

```
OnRobot RG2          Modbus TCP          ROS2 Node           RViz
    â”‚                    â”‚                    â”‚                â”‚
    â”‚â—„â”€â”€â”€Read Reg 267â”€â”€â”€â”€â”‚                    â”‚                â”‚
    â”‚â”€â”€â”€â”€Width (0.1mm)â”€â”€â–ºâ”‚                    â”‚                â”‚
    â”‚                    â”‚â”€â”€â”€â”€width_mmâ”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                â”‚
    â”‚                    â”‚                    â”‚â”€â”€joint_angleâ”€â”€â–ºâ”‚
    â”‚                    â”‚                    â”‚                â”‚
    â”‚â—„â”€â”€Write Reg 0,1,2â”€â”€â”‚â—„â”€â”€â”€width_cmdâ”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
    â”‚                    â”‚                    â”‚                â”‚
```

### 4.2 í­ â†’ ì¡°ì¸íŠ¸ ê°ë„ ë³€í™˜

**ë¬¸ì œ:** 
- ì‹¤ì œ ê·¸ë¦¬í¼: 0mm = ë‹«í˜, 110mm = ì—´ë¦¼
- URDF ì¡°ì¸íŠ¸: 0 rad = ì—´ë¦¼, 1.3 rad = ë‹«í˜ (ë°˜ëŒ€!)

**í•´ê²° (ë°˜ì „ ë§¤í•‘):**
```python
def width_to_joint_angle(self, width_mm: float) -> float:
    # 0~110mm â†’ 0~1ë¡œ ì •ê·œí™”
    normalized = width_mm / 110.0
    
    # ë°˜ì „: 0mm(ë‹«í˜) â†’ 1.3rad, 110mm(ì—´ë¦¼) â†’ 0rad
    angle = (1.0 - normalized) * 1.3
    
    return angle
```

| ì‹¤ì œ ê·¸ë¦¬í¼ | ì •ê·œí™” | ì¡°ì¸íŠ¸ ê°ë„ | RViz ìƒíƒœ |
|-------------|--------|-------------|-----------|
| 0mm (ë‹«í˜) | 0.0 | 1.3 rad | ë‹«í˜ |
| 55mm | 0.5 | 0.65 rad | ì¤‘ê°„ |
| 110mm (ì—´ë¦¼) | 1.0 | 0.0 rad | ì—´ë¦¼ |

---

## 5. URDF ì¡°ì¸íŠ¸ ë§¤í•‘

### 5.1 ê¸°ì¡´ URDF ë¶„ì„

**onrobot_description** íŒ¨í‚¤ì§€ì˜ URDF êµ¬ì¡°:

```xml
<!-- ë©”ì¸ ê·¸ë¦¬í¼ ì¡°ì¸íŠ¸ (revolute) -->
<joint name="gripper_joint" type="revolute">
  <limit lower="0.0" upper="1.3" effort="..." velocity="..."/>
</joint>

<!-- ë¯¸ëŸ¬ ì¡°ì¸íŠ¸ (ë°˜ëŒ€ìª½ ì†ê°€ë½) -->
<joint name="gripper_mirror_joint" type="revolute">
  <mimic joint="gripper_joint" multiplier="1"/>
</joint>
```

**í•µì‹¬ ë°œê²¬:**
- ì¡°ì¸íŠ¸ íƒ€ì…: `revolute` (ì›€ì§ì„ ê°€ëŠ¥) âœ…
- ì¡°ì¸íŠ¸ ì´ë¦„: `gripper_joint`, `gripper_mirror_joint`
- ì¡°ì¸íŠ¸ limit: 0.0 ~ 1.3 rad

### 5.2 ì¡°ì¸íŠ¸ ì´ë¦„ ë§¤í•‘

ì´ˆê¸°ì— ì˜ëª»ëœ ì¡°ì¸íŠ¸ ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ ë™ê¸°í™”ê°€ ì•ˆ ë˜ì—ˆìŠµë‹ˆë‹¤:

| ì‹œë„ | ì¡°ì¸íŠ¸ ì´ë¦„ | ê²°ê³¼ |
|------|-------------|------|
| âŒ 1ì°¨ | `gripper_finger_left_joint` | URDFì— ì—†ìŒ |
| âœ… ìµœì¢… | `gripper_joint`, `gripper_mirror_joint` | ë™ì‘ |

**í™•ì¸ ë°©ë²•:**
```bash
ros2 param get /dsr01/robot_state_publisher robot_description | grep -o '"gripper[^"]*joint"'
```

---

## 6. ROS2 í† í”½ êµ¬ì¡°

### 6.1 ë°œí–‰ í† í”½

| í† í”½ | íƒ€ì… | ì„¤ëª… | ë°œí–‰ ì£¼ê¸° |
|------|------|------|-----------|
| `/gripper/joint_states` | `sensor_msgs/JointState` | ê·¸ë¦¬í¼ ì¡°ì¸íŠ¸ ìƒíƒœ | 30Hz |
| `/gripper/width/current` | `std_msgs/Float32` | í˜„ì¬ í­ (mm) | 30Hz |
| `/gripper/grip_detected` | `std_msgs/Bool` | ë¬¼ì²´ ê°ì§€ | 30Hz |

### 6.2 êµ¬ë… í† í”½

| í† í”½ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| `/gripper/width/command` | `std_msgs/Float32` | ëª©í‘œ í­ ëª…ë ¹ (mm) |
| `/gripper/force/command` | `std_msgs/Float32` | ëª©í‘œ í˜ ëª…ë ¹ (N) |

### 6.3 ì„œë¹„ìŠ¤

| ì„œë¹„ìŠ¤ | íƒ€ì… | ì„¤ëª… |
|--------|------|------|
| `/gripper/open` | `std_srvs/Trigger` | ê·¸ë¦¬í¼ ì—´ê¸° (80mm) |
| `/gripper/close` | `std_srvs/Trigger` | ê·¸ë¦¬í¼ ë‹«ê¸° (0mm) |

### 6.4 í† í”½ íë¦„ ë‹¤ì´ì–´ê·¸ë¨

```
gripper_state_publisher
        â”‚
        â”œâ”€â”€â–º /gripper/joint_states â”€â”€â–º joint_state_merger â”€â”€â–º /dsr01/joint_states
        â”‚                                                            â”‚
        â”œâ”€â”€â–º /gripper/width/current                                  â–¼
        â”‚                                                    robot_state_publisher
        â””â”€â”€â–º /gripper/grip_detected                                  â”‚
                                                                     â–¼
gripper_controller                                              RViz (TF)
        â”‚
        â”œâ”€â”€â—„ /gripper/width/command
        â”œâ”€â”€â—„ /gripper/force/command
        â”œâ”€â”€â—„ /gripper/open (service)
        â””â”€â”€â—„ /gripper/close (service)
```

---

## 7. ì„¤ì¹˜ ë° ì‚¬ìš©ë²•

### 7.1 ì˜ì¡´ì„±

```bash
# pymodbus ì„¤ì¹˜
pip3 install pymodbus
```

### 7.2 ë¹Œë“œ

```bash
cd ~/ros2_ws
colcon build --packages-select gripper_rviz_sync
source install/setup.bash
```

### 7.3 ì‹¤í–‰

**í„°ë¯¸ë„ 1: ë¡œë´‡ + RViz**
```bash
ros2 launch gripper_camera_description dsr_bringup2_with_gripper.launch.py \
    mode:=real host:=192.168.1.100 port:=12345 model:=m0609
```

**í„°ë¯¸ë„ 2: ê·¸ë¦¬í¼ ë™ê¸°í™”**
```bash
ros2 launch gripper_rviz_sync gripper_sync.launch.py
```

### 7.4 ê·¸ë¦¬í¼ ì œì–´

```bash
# ê·¸ë¦¬í¼ ì—´ê¸°
ros2 service call /gripper/open std_srvs/srv/Trigger

# ê·¸ë¦¬í¼ ë‹«ê¸°
ros2 service call /gripper/close std_srvs/srv/Trigger

# íŠ¹ì • í­ìœ¼ë¡œ ì´ë™ (50mm)
ros2 topic pub --once /gripper/width/command std_msgs/msg/Float32 "data: 50.0"

# í˜ ì„¤ì • (25N)
ros2 topic pub --once /gripper/force/command std_msgs/msg/Float32 "data: 25.0"

# í˜„ì¬ í­ í™•ì¸
ros2 topic echo /gripper/width/current
```

### 7.5 ì—°ê²° í…ŒìŠ¤íŠ¸

```bash
# Modbus ì—°ê²° í…ŒìŠ¤íŠ¸
python3 ~/ros2_ws/src/gripper_rviz_sync/test_gripper.py 1

# ê·¸ë¦¬í¼ ì´ë™ í…ŒìŠ¤íŠ¸
python3 ~/ros2_ws/src/gripper_rviz_sync/test_gripper.py 2

# ROS2 í† í”½ ë°œí–‰ í…ŒìŠ¤íŠ¸
python3 ~/ros2_ws/src/gripper_rviz_sync/test_gripper.py 3
```

---

## 8. íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 8.1 RVizì—ì„œ ê·¸ë¦¬í¼ê°€ ì›€ì§ì´ì§€ ì•ŠìŒ

**ì›ì¸ 1: ì¡°ì¸íŠ¸ ì´ë¦„ ë¶ˆì¼ì¹˜**
```bash
# URDFì˜ ì¡°ì¸íŠ¸ ì´ë¦„ í™•ì¸
ros2 param get /dsr01/robot_state_publisher robot_description | grep -o '"gripper[^"]*joint"'
```

**ì›ì¸ 2: ì¡°ì¸íŠ¸ íƒ€ì…ì´ fixed**
- URDFì—ì„œ ì¡°ì¸íŠ¸ íƒ€ì…ì´ `fixed`ì´ë©´ ì›€ì§ì´ì§€ ì•ŠìŒ
- `onrobot_description` íŒ¨í‚¤ì§€ëŠ” `revolute` íƒ€ì… ì‚¬ìš© (OK)

### 8.2 ê·¸ë¦¬í¼ ë°©í–¥ì´ ë°˜ëŒ€ë¡œ ì›€ì§ì„

**ì›ì¸:** ì‹¤ì œ ê·¸ë¦¬í¼ì™€ URDFì˜ ë°©í–¥ì´ ë°˜ëŒ€

**í•´ê²°:** `gripper_state_publisher.py`ì—ì„œ ë°˜ì „ ë§¤í•‘ ì ìš©
```python
angle = (1.0 - normalized) * self.joint_max_angle
```

### 8.3 RVizì—ì„œ ê·¸ë¦¬í¼ê°€ íŠ€ëŠ” í˜„ìƒ

**ì›ì¸:** ë™ì¼ í† í”½ì— ì—¬ëŸ¬ publisherê°€ ë°œí–‰
```bash
ros2 topic info /dsr01/joint_states
# Publisher count: 2 ì´ìƒì´ë©´ ë¬¸ì œ
```

**í•´ê²°:** ëŸ°ì¹˜ íŒŒì¼ì„ í•˜ë‚˜ë§Œ ì‹¤í–‰

### 8.4 Modbus ì—°ê²° ì‹¤íŒ¨

```bash
# ping í…ŒìŠ¤íŠ¸
ping 192.168.1.1

# ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ í™•ì¸
ip addr | grep 192.168.1
```

**í•´ê²°:** PC IPë¥¼ 192.168.1.x ëŒ€ì—­ìœ¼ë¡œ ì„¤ì •

---

## 9. ì°¸ê³  ìë£Œ

### 9.1 ê³µì‹ ë¬¸ì„œ

| ë¬¸ì„œ | ë‚´ìš© |
|------|------|
| Doosan Robotics ì„¤ì¹˜ ë§¤ë‰´ì–¼ V2.8 | ë„¤íŠ¸ì›Œí¬ êµ¬ì„±, I/O ì¸í„°í˜ì´ìŠ¤ |
| Doosan Robotics í”„ë¡œê·¸ë˜ë° ë§¤ë‰´ì–¼ V2.8 | Modbus TCP Slave ì„¤ì • |
| OnRobot WebClient (192.168.1.1) | ê·¸ë¦¬í¼ ìƒíƒœ ëª¨ë‹ˆí„°ë§, ë„¤íŠ¸ì›Œí¬ ì„¤ì • |

### 9.2 GitHub ë ˆí¬ì§€í† ë¦¬

| ë ˆí¬ì§€í† ë¦¬ | ì°¸ê³  ë‚´ìš© |
|------------|-----------|
| [ian-chuang/OnRobot-RG2FT-ROS](https://github.com/ian-chuang/OnRobot-RG2FT-ROS) | Modbus ë ˆì§€ìŠ¤í„° ë§µ |
| [inria-paris-robotics-lab/onrobot_ros](https://github.com/inria-paris-robotics-lab/onrobot_ros) | URDF êµ¬ì¡°, ì¡°ì¸íŠ¸ ì´ë¦„ |

### 9.3 ë¶„ì„í•œ í•µì‹¬ ì •ë³´

**OnRobot Compute Box WebClient ìº¡ì²˜:**
- Device Info: RG2, S/N 1000037065, FW 1.0.6
- Network: 192.168.1.1, Subnet 255.255.255.0
- Current width: ì‹¤ì‹œê°„ í‘œì‹œ (Modbus í”¼ë“œë°± ê°€ëŠ¥ í™•ì¸)
- WebLogic: I/O ê¸°ë°˜ ì œì–´ í”„ë¡œê·¸ë¨ (ìš°ë¦¬ëŠ” Modbus ì§ì ‘ ì‚¬ìš©)

**Doosan I/O ì¸í„°í˜ì´ìŠ¤ PDF:**
- Tool Flange: M8 8í•€, ë””ì§€í„¸ I/Oë§Œ ì§€ì›
- ë„¤íŠ¸ì›Œí¬: M-seriesëŠ” WAN 1ê°œ + LAN 3ê°œ
- Modbus/TCP: Master(UI) / Slave(BG) ì§€ì›

---

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
gripper_rviz_sync/
â”œâ”€â”€ package.xml
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ README.md
â”œâ”€â”€ test_gripper.py              # ì—°ê²°/ì œì–´ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ config/
â”‚   â””â”€â”€ gripper_config.yaml      # ì„¤ì • íŒŒì¼
â”œâ”€â”€ gripper_rviz_sync/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ gripper_state_publisher.py   # Modbus â†’ ROS2 ì¡°ì¸íŠ¸ ìƒíƒœ
â”‚   â”œâ”€â”€ gripper_controller.py        # ROS2 â†’ Modbus ì œì–´
â”‚   â””â”€â”€ joint_state_merger.py        # ê·¸ë¦¬í¼ ì¡°ì¸íŠ¸ ë°œí–‰
â”œâ”€â”€ launch/
â”‚   â””â”€â”€ gripper_sync.launch.py   # ì „ì²´ ì‹œìŠ¤í…œ ëŸ°ì¹˜
â””â”€â”€ urdf/
    â””â”€â”€ onrobot_rg2_movable.urdf.xacro  # (ì°¸ê³ ìš©) ì›€ì§ì´ëŠ” URDF
```

---

## ğŸ“ License

MIT License

## ğŸ‘¥ Contributors

- ROKEY Bootcamp Team

---

*Last Updated: 2025-12-16*
